<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“± æ•°å­—äººæ ¼æ¡£æ¡ˆé¦† - æ•°æ®æ”¶é›†</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 20px;
        }
        .header h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }
        .header .subtitle {
            color: #666;
            font-size: 16px;
        }
        .form-group {
            margin-bottom: 25px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #444;
        }
        input, select {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            width: 100%;
        }
        input:focus, select:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }
        .app-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        .app-row input, .app-row select {
            height: 46px;
            min-width: 0; /* é‡è¦ï¼šé˜²æ­¢flexé¡¹æº¢å‡º */
        }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            white-space: nowrap;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .btn-add {
            background: #4CAF50;
            margin-top: 10px;
        }
        .btn-remove {
            background: #f44336;
            padding: 0;
            width: 46px;
            height: 46px;
            font-size: 20px;
            flex-shrink: 0;
        }
        .result {
            margin-top: 30px;
            padding: 25px;
            background: #f9f9f9;
            border-radius: 10px;
            display: none;
        }
        .personality-tag {
            display: inline-block;
            padding: 10px 20px;
            margin: 8px 5px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tag-social { background: #FF6B6B; color: white; }
        .tag-creator { background: #4ECDC4; color: white; }
        .tag-hidden { background: #45B7D1; color: white; }
        .tag-night { background: #96CEB4; color: white; }
        .tag-fragment { background: #FFEAA7; color: #333; }
        .tag-default { background: #A8A8A8; color: white; }
        .slogan {
            font-style: italic;
            color: #666;
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #667eea;
            background: #f8f9fa;
            border-radius: 0 8px 8px 0;
            font-size: 17px;
        }
        .time-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        .time-grid div {
            display: flex;
            flex-direction: column;
        }
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        .checkbox-grid label {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .checkbox-grid label:hover {
            background: #e9ecef;
        }
        .checkbox-grid input[type="checkbox"] {
            margin-right: 10px;
            width: 20px;
            height: 20px;
        }
        .app-name { flex: 3; min-width: 120px; }
        .app-time { flex: 2; min-width: 100px; }
        .app-category { flex: 2; min-width: 110px; }

        @media (max-width: 768px) {
            .app-row {
                flex-wrap: wrap;
            }
            .app-row > * {
                flex: 1 1 100%;
                margin-bottom: 10px;
            }
            .app-row .btn-remove {
                flex: 0 0 auto;
                width: 100%;
            }
            .time-grid {
                grid-template-columns: 1fr;
            }
            .checkbox-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“± æ•°å­—äººæ ¼æ¡£æ¡ˆé¦†</h1>
            <div class="subtitle">è®°å½•ä½ çš„æ•°å­—è¶³è¿¹ï¼Œè§£é”å†å²è§’è‰²</div>
        </div>

        <form id="dataForm" onsubmit="return false;">
            <!-- åŸºæœ¬ä¿¡æ¯ -->
            <div class="form-group">
                <label for="username">ä½ çš„ç§°å‘¼</label>
                <input type="text" id="username" placeholder="è¾“å…¥æ˜µç§°æˆ–å§“å" required>
            </div>

            <div class="form-group">
                <label for="date">è®°å½•æ—¥æœŸ</label>
                <input type="date" id="date" required>
            </div>

            <!-- Appä½¿ç”¨è®°å½•ï¼ˆå·²ä¿®å¤ï¼‰ -->
            <div class="form-group">
                <label>ğŸ“± App ä½¿ç”¨è®°å½•</label>
                <div id="appContainer">
                    <div class="app-row">
                        <input type="text" class="app-name" placeholder="Appåç§° (å¦‚: å¾®ä¿¡)" required>
                        <input type="number" class="app-time" placeholder="ä½¿ç”¨æ—¶é•¿ (åˆ†é’Ÿ)" min="0" required>
                        <select class="app-category">
                            <option value="ç¤¾äº¤">ç¤¾äº¤é€šè®¯</option>
                            <option value="åˆ›ä½œ">å†…å®¹åˆ›ä½œ</option>
                            <option value="å·¥å…·">ç³»ç»Ÿå·¥å…·</option>
                            <option value="å¨±ä¹">å½±éŸ³å¨±ä¹</option>
                            <option value="å­¦ä¹ ">å­¦ä¹ å·¥ä½œ</option>
                        </select>
                        <button type="button" class="btn btn-remove" onclick="removeAppRow(this)">Ã—</button>
                    </div>
                </div>
                <button type="button" class="btn btn-add" onclick="addAppRow()">+ æ·»åŠ æ›´å¤šApp</button>
            </div>

            <!-- ä½¿ç”¨æ—¶é—´æ®µåˆ†å¸ƒ -->
            <div class="form-group">
                <label>ğŸ• ä½¿ç”¨æ—¶é—´æ®µåˆ†å¸ƒ (åˆ†é’Ÿ)</label>
                <div class="time-grid">
                    <div>
                        <label for="morning">æ—©æ™¨ (6-12ç‚¹)</label>
                        <input type="number" id="morning" placeholder="åˆ†é’Ÿ" min="0" value="0">
                    </div>
                    <div>
                        <label for="afternoon">ä¸‹åˆ (12-18ç‚¹)</label>
                        <input type="number" id="afternoon" placeholder="åˆ†é’Ÿ" min="0" value="0">
                    </div>
                    <div>
                        <label for="evening">æ™šä¸Š (18-24ç‚¹)</label>
                        <input type="number" id="evening" placeholder="åˆ†é’Ÿ" min="0" value="0">
                    </div>
                    <div>
                        <label for="night">æ·±å¤œ (0-6ç‚¹)</label>
                        <input type="number" id="night" placeholder="åˆ†é’Ÿ" min="0" value="0">
                    </div>
                </div>
            </div>

            <!-- ä½¿ç”¨æ¨¡å¼ -->
            <div class="form-group">
                <label>ğŸ­ ä½¿ç”¨æ¨¡å¼</label>
                <div class="checkbox-grid">
                    <label>
                        <input type="checkbox" id="shortSessions" value="true">
                        çŸ­æ—¶é—´å¤šæ¬¡ä½¿ç”¨ (å•æ¬¡â‰¤2åˆ†é’Ÿ)
                    </label>
                    <label>
                        <input type="checkbox" id="nightUsage" value="true">
                        ç»å¸¸æ·±å¤œä½¿ç”¨ (0-5ç‚¹)
                    </label>
                    <label>
                        <input type="checkbox" id="createContent" value="true">
                        ç»å¸¸åˆ›ä½œå†…å®¹
                    </label>
                    <label>
                        <input type="checkbox" id="minimalSocial" value="true">
                        å¾ˆå°‘ä½¿ç”¨ç¤¾äº¤App
                    </label>
                </div>
            </div>

            <button type="button" class="btn" onclick="analyzeData()" style="width: 100%; padding: 15px; font-size: 18px;">
                ğŸ­ ç”Ÿæˆæ•°å­—äººæ ¼æŠ¥å‘Š
            </button>
        </form>

        <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
        <div id="result" class="result">
            <h3>ğŸ¯ ä½ çš„æ•°å­—äººæ ¼åˆ†ææŠ¥å‘Š</h3>
            <div id="personalityTags" style="margin: 20px 0;"></div>
            <div id="slogan" class="slogan"></div>

            <h4>ğŸ“Š è¯¦ç»†æ•°æ®ç»Ÿè®¡</h4>
            <div id="detailedData" style="margin: 15px 0;"></div>

            <div id="timeChart" style="margin: 20px 0; padding: 15px; background: white; border-radius: 8px;">
                <h5>â° æ—¶é—´æ®µåˆ†å¸ƒ</h5>
                <div id="chartContainer"></div>
            </div>

            <div style="margin-top: 25px; display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn" onclick="saveAsImage()" style="flex: 1; min-width: 150px;">
                    ğŸ“¸ ä¿å­˜ä¸ºå›¾ç‰‡
                </button>
                <button class="btn" onclick="exportData()" style="flex: 1; min-width: 150px;">
                    ğŸ“¥ å¯¼å‡ºæ•°æ®
                </button>
                <button class="btn" onclick="resetForm()" style="flex: 1; min-width: 150px;">
                    ğŸ”„ é‡æ–°å¡«å†™
                </button>
                <button class="btn" onclick="shareResult()" style="flex: 1; min-width: 150px;">
                    ğŸ“¤ åˆ†äº«ç»“æœ
                </button>
            </div>
        </div>
    </div>

    <script>
        // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
            // åˆå§‹æ·»åŠ ä¸€ä¸ªAppè¡Œ
            addAppRow();
        });

        // æ·»åŠ Appè¡Œ
        function addAppRow() {
            const container = document.getElementById('appContainer');
            const newRow = document.createElement('div');
            newRow.className = 'app-row';
            newRow.innerHTML = `
                <input type="text" class="app-name" placeholder="Appåç§°" required>
                <input type="number" class="app-time" placeholder="ä½¿ç”¨æ—¶é•¿" min="0" required>
                <select class="app-category">
                    <option value="ç¤¾äº¤">ç¤¾äº¤é€šè®¯</option>
                    <option value="åˆ›ä½œ">å†…å®¹åˆ›ä½œ</option>
                    <option value="å·¥å…·">ç³»ç»Ÿå·¥å…·</option>
                    <option value="å¨±ä¹">å½±éŸ³å¨±ä¹</option>
                    <option value="å­¦ä¹ ">å­¦ä¹ å·¥ä½œ</option>
                </select>
                <button type="button" class="btn btn-remove" onclick="removeAppRow(this)">Ã—</button>
            `;
            container.appendChild(newRow);

            // è‡ªåŠ¨èšç„¦åˆ°æ–°æ·»åŠ çš„Appåç§°è¾“å…¥æ¡†
            newRow.querySelector('.app-name').focus();
        }

        // ç§»é™¤Appè¡Œ
        function removeAppRow(button) {
            const rows = document.querySelectorAll('.app-row');
            if(rows.length > 1) {
                button.parentElement.remove();
            } else {
                alert('è‡³å°‘éœ€è¦ä¿ç•™ä¸€ä¸ªAppè®°å½•');
            }
        }

        // æ ¸å¿ƒåˆ†æå‡½æ•°
        function analyzeData() {
            // éªŒè¯å¿…è¦æ•°æ®
            const username = document.getElementById('username').value;
            if(!username.trim()) {
                alert('è¯·è¾“å…¥ä½ çš„ç§°å‘¼');
                document.getElementById('username').focus();
                return;
            }

            // æ”¶é›†æ•°æ®
            const date = document.getElementById('date').value;

            // æ”¶é›†Appæ•°æ®
            const appRows = document.querySelectorAll('.app-row');
            let totalTime = 0;
            let socialTime = 0;
            let createTime = 0;
            let toolTime = 0;
            let entertainmentTime = 0;
            let learnTime = 0;
            const apps = [];
            let isValid = true;

            appRows.forEach((row, index) => {
                const name = row.querySelector('.app-name').value.trim();
                const time = parseInt(row.querySelector('.app-time').value) || 0;
                const category = row.querySelector('.app-category').value;

                // éªŒè¯Appåç§°
                if(!name) {
                    alert(`ç¬¬${index + 1}ä¸ªAppåç§°ä¸èƒ½ä¸ºç©º`);
                    row.querySelector('.app-name').focus();
                    isValid = false;
                    return;
                }

                // éªŒè¯æ—¶é•¿
                if(time <= 0) {
                    alert(`"${name}"çš„æ—¶é•¿å¿…é¡»å¤§äº0åˆ†é’Ÿ`);
                    row.querySelector('.app-time').focus();
                    isValid = false;
                    return;
                }

                totalTime += time;

                // åˆ†ç±»ç»Ÿè®¡
                switch(category) {
                    case 'ç¤¾äº¤': socialTime += time; break;
                    case 'åˆ›ä½œ': createTime += time; break;
                    case 'å·¥å…·': toolTime += time; break;
                    case 'å¨±ä¹': entertainmentTime += time; break;
                    case 'å­¦ä¹ ': learnTime += time; break;
                }

                apps.push({name, time, category});
            });

            if(!isValid) return;

            if(totalTime === 0) {
                alert('è¯·è‡³å°‘è¾“å…¥ä¸€ä¸ªAppçš„ä½¿ç”¨æ—¶é•¿');
                return;
            }

            // æ”¶é›†æ—¶æ®µæ•°æ®
            const morningTime = parseInt(document.getElementById('morning').value) || 0;
            const afternoonTime = parseInt(document.getElementById('afternoon').value) || 0;
            const eveningTime = parseInt(document.getElementById('evening').value) || 0;
            const nightTime = parseInt(document.getElementById('night').value) || 0;

            // è®¡ç®—æ—¶æ®µæ€»å’Œç”¨äºéªŒè¯
            const totalPeriodTime = morningTime + afternoonTime + eveningTime + nightTime;
            if(totalPeriodTime > totalTime * 1.5) {
                if(!confirm('æ—¶é—´æ®µæ€»å’Œå¯èƒ½è¶…è¿‡æ€»ä½¿ç”¨æ—¶é—´ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ')) return;
            }

            // æ”¶é›†ä½¿ç”¨æ¨¡å¼
            const hasShortSessions = document.getElementById('shortSessions').checked;
            const hasNightUsage = document.getElementById('nightUsage').checked;
            const hasCreateContent = document.getElementById('createContent').checked;
            const hasMinimalSocial = document.getElementById('minimalSocial').checked;

            // è®¡ç®—æ¯”ç‡
            const socialRatio = totalTime > 0 ? socialTime / totalTime : 0;
            const toolRatio = totalTime > 0 ? toolTime / totalTime : 0;
            const nightRatio = totalTime > 0 ? nightTime / totalTime : 0;
            const createRatio = totalTime > 0 ? createTime / totalTime : 0;

            // åˆ¤æ–­äººæ ¼æ ‡ç­¾
            const tags = [];

            // 1. ç¤¾åª’é‡åº¦ä¾èµ–å‹äººæ ¼ (ç¤¾äº¤â‰¥150minä¸”å æ¯”â‰¥60%)
            if(socialTime >= 150 && socialRatio >= 0.6) {
                tags.push({
                    name: "ç¤¾åª’é‡åº¦ä¾èµ–å‹",
                    class: "tag-social",
                    slogan: "äººæ°‘åˆ·å±çš„æ¯ä¸€ç§’ï¼Œéƒ½åœ¨é›•åˆ»é›†ä½“è®°å¿†ã€‚",
                    description: "ä½ çš„æ•°å­—ç”Ÿæ´»åœ¨ç¤¾äº¤ç½‘ç»œä¸­æ·±æ·±æ‰æ ¹"
                });
            }

            // 2. å†…å®¹è€•ä½œè€… (åˆ›ä½œâ‰¥90minæˆ–ç»å¸¸åˆ›ä½œ)
            if(createTime >= 90 || hasCreateContent) {
                tags.push({
                    name: "å†…å®¹è€•ä½œè€…",
                    class: "tag-creator",
                    slogan: "ç¾¤ä¼—ç”Ÿäº§å†…å®¹ï¼Œå°±åƒåœ¨å†å²ç”°é‡é‡Œæ’ç§§ã€‚",
                    description: "ä½ æ˜¯æ•°å­—ä¸–ç•Œçš„åˆ›ä½œè€…å’Œæ’­ç§è€…"
                });
            }

            // 3. æ•°å­—éšè€… (ç¤¾äº¤<10%ä¸”å·¥å…·>50%)
            if(socialRatio < 0.1 && toolRatio > 0.5) {
                tags.push({
                    name: "æ•°å­—éšè€…",
                    class: "tag-hidden",
                    slogan: "æ²‰é»˜ä¹Ÿæ˜¯å†å²çš„ä¸€éƒ¨åˆ†ã€‚",
                    description: "åœ¨æ•°å­—ä¸–ç•Œä¸­ä¿æŒä¸“æ³¨ä¸å†…çœ"
                });
            }

            // 4. å¤œè¡Œå²å®˜ (æ·±å¤œå æ¯”â‰¥30%æˆ–ç»å¸¸æ·±å¤œä½¿ç”¨)
            if(nightRatio >= 0.3 || hasNightUsage) {
                tags.push({
                    name: "å¤œè¡Œå²å®˜",
                    class: "tag-night",
                    slogan: "æ·±å¤œçš„æ¯ä¸€æ¬¡ç‚¹äº®ï¼Œéƒ½æ˜¯ç¾¤ä¼—åœ¨åŠ ç­å†™å²ã€‚",
                    description: "åœ¨å¯‚é™çš„å¤œæ™šè®°å½•æ•°å­—è½¨è¿¹"
                });
            }

            // 5. ç¢ç‰‡æ‹¼è´´å¸ˆ (çŸ­æ—¶é—´å¤šæ¬¡ä½¿ç”¨)
            if(hasShortSessions) {
                tags.push({
                    name: "ç¢ç‰‡æ‹¼è´´å¸ˆ",
                    class: "tag-fragment",
                    slogan: "å†çŸ­çš„ä¸€æ¬¡ç‚¹å‡»ï¼Œä¹Ÿæ˜¯å†å²æ‹¼å›¾çš„ä¸€å—ã€‚",
                    description: "æ“…é•¿åœ¨ç¢ç‰‡æ—¶é—´ä¸­ç¼–ç»‡æ•°å­—ç”Ÿæ´»"
                });
            }

            // é¢å¤–æ ‡ç­¾ï¼šå­¦ä¹ è¾¾äºº
            if(learnTime >= 120) {
                tags.push({
                    name: "æ•°å­—å­¦è€…",
                    class: "tag-default",
                    slogan: "æ¯ä¸€æ¬¡å­¦ä¹ ï¼Œéƒ½æ˜¯å¯¹æœªæ¥çš„æŠ•èµ„ã€‚",
                    description: "åœ¨æ•°å­—ä¸–ç•Œä¸­æŒç»­æˆé•¿"
                });
            }

            // å¦‚æœæ²¡æœ‰æ ‡ç­¾ï¼Œæ·»åŠ é»˜è®¤
            if(tags.length === 0) {
                tags.push({
                    name: "æ•°å­—å¹³è¡¡è€…",
                    class: "tag-default",
                    slogan: "ä½ çš„æ•°å­—è¶³è¿¹æ­£åœ¨å½¢æˆç‹¬ç‰¹çš„å†å²è½¨è¿¹ã€‚",
                    description: "åœ¨æ•°å­—ç”Ÿæ´»ä¸­ä¿æŒå¥åº·å¹³è¡¡"
                });
            }

            // æ˜¾ç¤ºç»“æœ
            displayResults(username, date, totalTime, tags, apps, {
                socialTime, createTime, toolTime, entertainmentTime, learnTime,
                morningTime, afternoonTime, eveningTime, nightTime
            });
        }

        function displayResults(username, date, totalTime, tags, apps, stats) {
            const resultDiv = document.getElementById('result');
            const tagsDiv = document.getElementById('personalityTags');
            const sloganDiv = document.getElementById('slogan');
            const detailDiv = document.getElementById('detailedData');
            const chartDiv = document.getElementById('chartContainer');

            // æ˜¾ç¤ºæ ‡ç­¾
            tagsDiv.innerHTML = '<strong>ğŸ·ï¸ è·å¾—çš„äººæ ¼æ ‡ç­¾ï¼š</strong><br><br>';
            tags.forEach(tag => {
                tagsDiv.innerHTML += `
                    <span class="personality-tag ${tag.class}" title="${tag.description}">
                        ${tag.name}
                    </span>
                `;
            });

            // æ˜¾ç¤ºéšæœºå£å·
            const randomTag = tags[Math.floor(Math.random() * tags.length)];
            sloganDiv.innerHTML = `ğŸ’­ <strong>ä¸“å±å¯„è¯­ï¼š</strong>"${randomTag.slogan}"`;

            // è®¡ç®—å„ç±»åˆ«å æ¯”
            const socialPercent = totalTime > 0 ? (stats.socialTime / totalTime * 100).toFixed(1) : 0;
            const createPercent = totalTime > 0 ? (stats.createTime / totalTime * 100).toFixed(1) : 0;
            const toolPercent = totalTime > 0 ? (stats.toolTime / totalTime * 100).toFixed(1) : 0;
            const entertainmentPercent = totalTime > 0 ? (stats.entertainmentTime / totalTime * 100).toFixed(1) : 0;
            const learnPercent = totalTime > 0 ? (stats.learnTime / totalTime * 100).toFixed(1) : 0;

            // æ˜¾ç¤ºè¯¦ç»†æ•°æ®
            detailDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <strong>ğŸ‘¤ ç”¨æˆ·</strong><br>${username}
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <strong>ğŸ“… æ—¥æœŸ</strong><br>${date}
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <strong>â±ï¸ æ€»æ—¶é•¿</strong><br>${totalTime} åˆ†é’Ÿ
                    </div>
                </div>

                <h5>ğŸ“Š ä½¿ç”¨ç±»åˆ«åˆ†å¸ƒ</h5>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin: 10px 0;">
                    <div style="background: #FF6B6B20; padding: 10px; border-radius: 6px; border-left: 4px solid #FF6B6B;">
                        <strong>ç¤¾äº¤é€šè®¯</strong><br>${stats.socialTime}åˆ†é’Ÿ (${socialPercent}%)
                    </div>
                    <div style="background: #4ECDC420; padding: 10px; border-radius: 6px; border-left: 4px solid #4ECDC4;">
                        <strong>å†…å®¹åˆ›ä½œ</strong><br>${stats.createTime}åˆ†é’Ÿ (${createPercent}%)
                    </div>
                    <div style="background: #45B7D120; padding: 10px; border-radius: 6px; border-left: 4px solid #45B7D1;">
                        <strong>ç³»ç»Ÿå·¥å…·</strong><br>${stats.toolTime}åˆ†é’Ÿ (${toolPercent}%)
                    </div>
                    <div style="background: #FFEAA720; padding: 10px; border-radius: 6px; border-left: 4px solid #FFEAA7;">
                        <strong>å½±éŸ³å¨±ä¹</strong><br>${stats.entertainmentTime}åˆ†é’Ÿ (${entertainmentPercent}%)
                    </div>
                    <div style="background: #A8A8A820; padding: 10px; border-radius: 6px; border-left: 4px solid #A8A8A8;">
                        <strong>å­¦ä¹ å·¥ä½œ</strong><br>${stats.learnTime}åˆ†é’Ÿ (${learnPercent}%)
                    </div>
                </div>

                <h5>ğŸ“± Appä½¿ç”¨è¯¦æƒ…</h5>
                <div style="max-height: 200px; overflow-y: auto; margin: 10px 0; padding: 10px; background: white; border-radius: 8px;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">Appåç§°</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">ç±»åˆ«</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">æ—¶é•¿(åˆ†é’Ÿ)</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">å æ¯”</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${apps.map(app => {
                                const percent = totalTime > 0 ? ((app.time / totalTime) * 100).toFixed(1) : 0;
                                return `
                                    <tr>
                                        <td style="padding: 10px; border-bottom: 1px solid #eee;">${app.name}</td>
                                        <td style="padding: 10px; border-bottom: 1px solid #eee;">${app.category}</td>
                                        <td style="padding: 10px; border-bottom: 1px solid #eee;">${app.time}</td>
                                        <td style="padding: 10px; border-bottom: 1px solid #eee;">${percent}%</td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;

            // ç”Ÿæˆç®€å•çš„æ—¶é—´æ®µå›¾è¡¨
            chartDiv.innerHTML = `
                <div style="display: flex; align-items: flex-end; height: 150px; gap: 20px; margin-top: 10px;">
                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                        <div style="background: #96CEB4; width: 80%; height: ${(stats.morningTime / (totalTime || 1)) * 100}px; border-radius: 4px 4px 0 0;"></div>
                        <div style="margin-top: 5px; font-size: 12px;">æ—©æ™¨<br>${stats.morningTime}åˆ†</div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                        <div style="background: #FFEAA7; width: 80%; height: ${(stats.afternoonTime / (totalTime || 1)) * 100}px; border-radius: 4px 4px 0 0;"></div>
                        <div style="margin-top: 5px; font-size: 12px;">ä¸‹åˆ<br>${stats.afternoonTime}åˆ†</div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                        <div style="background: #FF6B6B; width: 80%; height: ${(stats.eveningTime / (totalTime || 1)) * 100}px; border-radius: 4px 4px 0 0;"></div>
                        <div style="margin-top: 5px; font-size: 12px;">æ™šä¸Š<br>${stats.eveningTime}åˆ†</div>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                        <div style="background: #764ba2; width: 80%; height: ${(stats.nightTime / (totalTime || 1)) * 100}px; border-radius: 4px 4px 0 0;"></div>
                        <div style="margin-top: 5px; font-size: 12px;">æ·±å¤œ<br>${stats.nightTime}åˆ†</div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 10px; color: #666; font-size: 14px;">
                    å„æ—¶æ®µä½¿ç”¨æ—¶é•¿å¯¹æ¯”
                </div>
            `;

            // æ˜¾ç¤ºç»“æœåŒºåŸŸ
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({behavior: 'smooth'});
        }

        // ä¿å­˜ä¸ºå›¾ç‰‡
        function saveAsImage() {
            alert('æç¤ºï¼šè¦ä½¿ç”¨æˆªå›¾åŠŸèƒ½ï¼Œè¯·åœ¨HTMLå¤´éƒ¨æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š\n\n' +
                  '<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"><\/script>\n\n' +
                  'ç„¶åå–æ¶ˆæ³¨é‡ŠsaveAsImageå‡½æ•°ä¸­çš„ä»£ç ');

            /* å¯ç”¨æˆªå›¾åŠŸèƒ½çš„ä»£ç ï¼š
            html2canvas(document.getElementById('result')).then(canvas => {
                const link = document.createElement('a');
                link.download = `æ•°å­—äººæ ¼æŠ¥å‘Š_${document.getElementById('username').value}_${new Date().toISOString().slice(0,10)}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
            */
        }

        // å¯¼å‡ºæ•°æ®
        function exportData() {
            const username = document.getElementById('username').value || 'åŒ¿åç”¨æˆ·';
            const data = {
                ç”¨æˆ·: username,
                è®°å½•æ—¥æœŸ: document.getElementById('date').value,
                åˆ†ææ—¶é—´: new Date().toLocaleString('zh-CN'),
                äººæ ¼æ ‡ç­¾: Array.from(document.querySelectorAll('.personality-tag')).map(tag => tag.textContent),
                è¯¦ç»†æŠ¥å‘Š: document.getElementById('result').innerText
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `æ•°å­—äººæ ¼æ¡£æ¡ˆ_${username}_${new Date().toISOString().slice(0,10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert(`æ•°æ®å·²å¯¼å‡ºä¸ºJSONæ–‡ä»¶ï¼š${a.download}`);
        }

        // åˆ†äº«ç»“æœ
        function shareResult() {
            const tags = Array.from(document.querySelectorAll('.personality-tag'))
                .map(tag => tag.textContent)
                .join('ã€');

            const text = `ğŸ“± æˆ‘çš„æ•°å­—äººæ ¼åˆ†æï¼š${tags}\n` +
                        `ğŸ’­ ${document.getElementById('slogan').textContent}\n` +
                        `ğŸ“Š æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Šï¼š`;

            if(navigator.share) {
                navigator.share({
                    title: 'æˆ‘çš„æ•°å­—äººæ ¼æŠ¥å‘Š',
                    text: text,
                    url: window.location.href
                });
            } else {
                prompt('å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ†äº«ç»™æœ‹å‹ï¼š', text);
            }
        }

        // é‡ç½®è¡¨å•
        function resetForm() {
            if(confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿ')) {
                document.getElementById('dataForm').reset();
                document.getElementById('result').style.display = 'none';

                // é‡ç½®æ—¥æœŸä¸ºä»Šå¤©
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('date').value = today;

                // åªä¿ç•™ä¸€ä¸ªAppè¡Œå¹¶æ¸…ç©º
                const container = document.getElementById('appContainer');
                while(container.children.length > 1) {
                    container.removeChild(container.lastChild);
                }

                // æ¸…ç©ºç¬¬ä¸€ä¸ªAppè¡Œ
                const firstRow = container.firstElementChild;
                firstRow.querySelector('.app-name').value = '';
                firstRow.querySelector('.app-time').value = '';
                firstRow.querySelector('.app-category').selectedIndex = 0;

                // é‡ç½®æ—¶é—´æ®µ
                ['morning', 'afternoon', 'evening', 'night'].forEach(id => {
                    document.getElementById(id).value = '0';
                });

                // èšç„¦åˆ°ç”¨æˆ·åè¾“å…¥æ¡†
                document.getElementById('username').focus();
            }
        }

        // é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', function(e) {
            // Ctrl+Enter æäº¤è¡¨å•
            if(e.ctrlKey && e.key === 'Enter') {
                analyzeData();
            }
            // Esc é‡ç½®è¡¨å•
            if(e.key === 'Escape') {
                resetForm();
            }
        });
    </script>
</body>

</html>
